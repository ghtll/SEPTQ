CUDA extension not installed.
Starting ...
Ready.
========================================
Start compressing layer 0：
layers[0].self_attn.k_proj
time 4.02
========================================
layers[0].self_attn.v_proj
time 3.19
========================================
layers[0].self_attn.q_proj
time 3.05
========================================
layers[0].self_attn.out_proj
time 2.62
========================================
layers[0].fc1
time 3.48
========================================
layers[0].fc2
time 10.82
========================================
========================================
Start compressing layer 1：
layers[1].self_attn.k_proj
time 3.28
========================================
layers[1].self_attn.v_proj
time 3.24
========================================
layers[1].self_attn.q_proj
time 2.81
========================================
layers[1].self_attn.out_proj
time 2.73
========================================
layers[1].fc1
time 3.38
========================================
layers[1].fc2
time 10.73
========================================
========================================
Start compressing layer 2：
layers[2].self_attn.k_proj
time 3.23
========================================
layers[2].self_attn.v_proj
time 3.16
========================================
layers[2].self_attn.q_proj
time 2.94
========================================
layers[2].self_attn.out_proj
time 2.57
========================================
layers[2].fc1
time 3.39
========================================
layers[2].fc2
time 11.06
========================================
========================================
Start compressing layer 3：
layers[3].self_attn.k_proj
time 3.15
========================================
layers[3].self_attn.v_proj
time 3.07
========================================
layers[3].self_attn.q_proj
time 2.94
========================================
layers[3].self_attn.out_proj
time 2.43
========================================
layers[3].fc1
time 3.40
========================================
layers[3].fc2
time 10.72
========================================
========================================
Start compressing layer 4：
layers[4].self_attn.k_proj
time 3.03
========================================
layers[4].self_attn.v_proj
time 3.01
========================================
layers[4].self_attn.q_proj
time 2.93
========================================
layers[4].self_attn.out_proj
time 2.48
========================================
layers[4].fc1
time 3.36
========================================
layers[4].fc2
time 10.98
========================================
========================================
Start compressing layer 5：
layers[5].self_attn.k_proj
time 3.25
========================================
layers[5].self_attn.v_proj
time 3.19
========================================
layers[5].self_attn.q_proj
time 3.09
========================================
layers[5].self_attn.out_proj
time 2.65
========================================
layers[5].fc1
time 3.56
========================================
layers[5].fc2
time 10.97
========================================
========================================
Start compressing layer 6：
layers[6].self_attn.k_proj
time 3.24
========================================
layers[6].self_attn.v_proj
time 3.13
========================================
layers[6].self_attn.q_proj
time 3.05
========================================
layers[6].self_attn.out_proj
time 2.52
========================================
layers[6].fc1
time 3.64
========================================
layers[6].fc2
time 10.60
========================================
========================================
Start compressing layer 7：
layers[7].self_attn.k_proj
time 3.13
========================================
layers[7].self_attn.v_proj
time 3.07
========================================
layers[7].self_attn.q_proj
time 2.89
========================================
layers[7].self_attn.out_proj
time 2.41
========================================
layers[7].fc1
time 3.48
========================================
layers[7].fc2
time 10.56
========================================
========================================
Start compressing layer 8：
layers[8].self_attn.k_proj
time 3.17
========================================
layers[8].self_attn.v_proj
time 2.94
========================================
layers[8].self_attn.q_proj
time 3.12
========================================
layers[8].self_attn.out_proj
time 2.55
========================================
layers[8].fc1
time 3.39
========================================
layers[8].fc2
time 11.32
========================================
========================================
Start compressing layer 9：
layers[9].self_attn.k_proj
time 3.14
========================================
layers[9].self_attn.v_proj
time 3.21
========================================
layers[9].self_attn.q_proj
time 3.11
========================================
layers[9].self_attn.out_proj
time 2.64
========================================
layers[9].fc1
time 3.46
========================================
layers[9].fc2
time 10.70
========================================
========================================
Start compressing layer 10：
layers[10].self_attn.k_proj
time 3.08
========================================
layers[10].self_attn.v_proj
time 3.20
========================================
layers[10].self_attn.q_proj
time 2.88
========================================
layers[10].self_attn.out_proj
time 2.63
========================================
layers[10].fc1
time 3.34
========================================
layers[10].fc2
time 10.92
========================================
========================================
Start compressing layer 11：
layers[11].self_attn.k_proj
time 3.08
========================================
layers[11].self_attn.v_proj
time 3.13
========================================
layers[11].self_attn.q_proj
time 2.87
========================================
layers[11].self_attn.out_proj
time 2.41
========================================
layers[11].fc1
time 3.45
========================================
layers[11].fc2
time 10.81
========================================
========================================
Start compressing layer 12：
layers[12].self_attn.k_proj
time 3.09
========================================
layers[12].self_attn.v_proj
time 3.04
========================================
layers[12].self_attn.q_proj
time 2.90
========================================
layers[12].self_attn.out_proj
time 2.48
========================================
layers[12].fc1
time 3.39
========================================
layers[12].fc2
time 10.82
========================================
========================================
Start compressing layer 13：
layers[13].self_attn.k_proj
time 3.10
========================================
layers[13].self_attn.v_proj
time 3.10
========================================
layers[13].self_attn.q_proj
time 2.87
========================================
layers[13].self_attn.out_proj
time 2.53
========================================
layers[13].fc1
time 3.47
========================================
layers[13].fc2
time 10.79
========================================
========================================
Start compressing layer 14：
layers[14].self_attn.k_proj
time 3.02
========================================
layers[14].self_attn.v_proj
time 2.95
========================================
layers[14].self_attn.q_proj
time 2.77
========================================
layers[14].self_attn.out_proj
time 2.35
========================================
layers[14].fc1
time 3.44
========================================
layers[14].fc2
time 10.79
========================================
========================================
Start compressing layer 15：
layers[15].self_attn.k_proj
time 3.19
========================================
layers[15].self_attn.v_proj
time 3.12
========================================
layers[15].self_attn.q_proj
time 2.93
========================================
layers[15].self_attn.out_proj
time 2.58
========================================
layers[15].fc1
time 3.40
========================================
layers[15].fc2
time 10.71
========================================
========================================
Start compressing layer 16：
layers[16].self_attn.k_proj
time 3.07
========================================
layers[16].self_attn.v_proj
time 3.12
========================================
layers[16].self_attn.q_proj
time 2.87
========================================
layers[16].self_attn.out_proj
time 2.42
========================================
layers[16].fc1
time 3.40
========================================
layers[16].fc2
time 11.09
========================================
========================================
Start compressing layer 17：
layers[17].self_attn.k_proj
time 3.09
========================================
layers[17].self_attn.v_proj
time 3.05
========================================
layers[17].self_attn.q_proj
time 3.01
========================================
layers[17].self_attn.out_proj
time 2.51
========================================
layers[17].fc1
time 3.43
========================================
layers[17].fc2
time 10.69
========================================
========================================
Start compressing layer 18：
layers[18].self_attn.k_proj
time 3.16
========================================
layers[18].self_attn.v_proj
time 3.06
========================================
layers[18].self_attn.q_proj
time 2.92
========================================
layers[18].self_attn.out_proj
time 2.45
========================================
layers[18].fc1
time 3.44
========================================
layers[18].fc2
time 10.99
========================================
========================================
Start compressing layer 19：
layers[19].self_attn.k_proj
time 3.14
========================================
layers[19].self_attn.v_proj
time 3.11
========================================
layers[19].self_attn.q_proj
time 2.88
========================================
layers[19].self_attn.out_proj
time 2.40
========================================
layers[19].fc1
time 3.52
========================================
layers[19].fc2
time 10.61
========================================
========================================
Start compressing layer 20：
layers[20].self_attn.k_proj
time 3.07
========================================
layers[20].self_attn.v_proj
time 3.03
========================================
layers[20].self_attn.q_proj
time 2.89
========================================
layers[20].self_attn.out_proj
time 2.47
========================================
layers[20].fc1
time 3.35
========================================
layers[20].fc2
time 11.18
========================================
========================================
Start compressing layer 21：
layers[21].self_attn.k_proj
time 3.01
========================================
layers[21].self_attn.v_proj
time 3.05
========================================
layers[21].self_attn.q_proj
time 3.05
========================================
layers[21].self_attn.out_proj
time 2.66
========================================
layers[21].fc1
time 3.86
========================================
layers[21].fc2
time 10.81
========================================
========================================
Start compressing layer 22：
layers[22].self_attn.k_proj
time 3.33
========================================
layers[22].self_attn.v_proj
time 3.25
========================================
layers[22].self_attn.q_proj
time 2.88
========================================
layers[22].self_attn.out_proj
time 2.43
========================================
layers[22].fc1
time 3.34
========================================
layers[22].fc2
time 10.96
========================================
========================================
Start compressing layer 23：
layers[23].self_attn.k_proj
time 3.20
========================================
layers[23].self_attn.v_proj
time 3.07
========================================
layers[23].self_attn.q_proj
time 2.91
========================================
layers[23].self_attn.out_proj
time 2.55
========================================
layers[23].fc1
time 3.73
========================================
layers[23].fc2
time 10.55
========================================
========================================
Start compressing layer 24：
layers[24].self_attn.k_proj
time 3.06
========================================
layers[24].self_attn.v_proj
time 3.05
========================================
layers[24].self_attn.q_proj
time 2.90
========================================
layers[24].self_attn.out_proj
time 2.83
========================================
layers[24].fc1
time 3.41
========================================
layers[24].fc2
time 11.27
========================================
========================================
Start compressing layer 25：
layers[25].self_attn.k_proj
time 3.17
========================================
layers[25].self_attn.v_proj
time 3.35
========================================
layers[25].self_attn.q_proj
time 3.08
========================================
layers[25].self_attn.out_proj
time 2.89
========================================
layers[25].fc1
time 3.47
========================================
layers[25].fc2
time 11.20
========================================
========================================
Start compressing layer 26：
layers[26].self_attn.k_proj
time 3.48
========================================
layers[26].self_attn.v_proj
time 3.24
========================================
layers[26].self_attn.q_proj
time 3.03
========================================
layers[26].self_attn.out_proj
time 2.59
========================================
layers[26].fc1
time 3.38
========================================
layers[26].fc2
time 10.78
========================================
========================================
Start compressing layer 27：
layers[27].self_attn.k_proj
time 3.21
========================================
layers[27].self_attn.v_proj
time 3.30
========================================
layers[27].self_attn.q_proj
time 2.87
========================================
layers[27].self_attn.out_proj
time 2.48
========================================
layers[27].fc1
time 3.40
========================================
layers[27].fc2
time 10.68
========================================
========================================
Start compressing layer 28：
layers[28].self_attn.k_proj
time 3.10
========================================
layers[28].self_attn.v_proj
time 2.98
========================================
layers[28].self_attn.q_proj
time 2.98
========================================
layers[28].self_attn.out_proj
time 2.50
========================================
layers[28].fc1
time 3.36
========================================
layers[28].fc2
time 10.72
========================================
========================================
Start compressing layer 29：
layers[29].self_attn.k_proj
time 3.19
========================================
layers[29].self_attn.v_proj
time 3.03
========================================
layers[29].self_attn.q_proj
time 2.96
========================================
layers[29].self_attn.out_proj
time 2.49
========================================
layers[29].fc1
time 3.40
========================================
layers[29].fc2
time 10.77
========================================
========================================
Start compressing layer 30：
layers[30].self_attn.k_proj
time 3.08
========================================
layers[30].self_attn.v_proj
time 2.96
========================================
layers[30].self_attn.q_proj
time 2.87
========================================
layers[30].self_attn.out_proj
time 2.55
========================================
layers[30].fc1
time 3.36
========================================
layers[30].fc2
time 10.77
========================================
========================================
Start compressing layer 31：
layers[31].self_attn.k_proj
time 3.36
========================================
layers[31].self_attn.v_proj
time 3.28
========================================
layers[31].self_attn.q_proj
time 2.88
========================================
layers[31].self_attn.out_proj
time 2.45
========================================
layers[31].fc1
time 3.42
========================================
layers[31].fc2
time 11.04
========================================
time
1342.7536687850952
wikitext2
Evaluating ...
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
11.137177467346191
ptb-new
Evaluating ...
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
16.26846694946289
c4-new
Evaluating ...
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
13.05291748046875
